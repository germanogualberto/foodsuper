<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Supermercados</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <h1>Supermercados Disponiveis</h1>

    <script>
        function carregaSupermercados() {
            var dados = getSupermercados();
            console.log(dados);

            for (i in dados) {
                console.log(dados[i]);
                
                // 1. Create the button
                var button = document.createElement("button");
                button.innerHTML = dados[i].name;
                console.log(dados[i]._id);
                //button.id = dados[i]._id;

                button.setAttribute('id',dados[i]._id);
                // 2. Append somewhere
                var list = document.getElementById("supermercados");
                list.appendChild(button);

                // 3. Add event handler
                button.addEventListener("click", function () {
                    alert(button.getAttribute('id'));
                });

            }


        }

        function loadSupermercado() {
            alert("deu certo");
        }
    </script>
</head>

<body onload="carregaSupermercados()">

    <div id="supermercados">
        
    </div>

    <br><button onclick="voltaTelaPrincipal()">voltar</button>

    <script>
        function voltaTelaPrincipal() {
            window.location.href = "mainUsuario.html";
        }
        function verPrateleira() {
            window.location.href = "prateleira.html";

        }
        function getSupermercados() {
            const Http = new XMLHttpRequest();
            const url = 'http://localhost:3000/supermarket';
            Http.open("GET", url, false);
            //Http.setRequestHeader('Authorization', 'Bearer ' + localStorage.getItem('token'));

            Http.send(null);

            var obj = JSON.parse(Http.responseText);
            //alert(obj.token);

            Http.onreadystatechange = (e) => {
                console.log(Http.responseText);
                // Request finished. Do processing here.
            };
            console.log(obj);
            return obj;
        }
    </script>
</body>

</html>